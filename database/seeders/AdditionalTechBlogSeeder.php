<?php

namespace Database\Seeders;

use App\Models\BlogPost;
use App\Models\User;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;

class AdditionalTechBlogSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Get the first user or create one if none exists
        $user = User::first();
        if (!$user) {
            $user = User::factory()->create([
                'name' => 'Admin User',
                'email' => 'admin@example.com',
                'password' => bcrypt('password'),
            ]);
        }

        $blogPosts = [
            [
                'title' => 'React 18: New Features and Performance Improvements',
                'excerpt' => 'Explore the latest React 18 features including concurrent rendering, automatic batching, and the new Suspense capabilities.',
                'content' => "# React 18: New Features and Performance Improvements\n\nReact 18 introduces groundbreaking features that enhance both developer experience and application performance. This comprehensive guide covers all the new capabilities and how to leverage them effectively.\n\n## What's New in React 18\n\n### 1. Concurrent Rendering\n- **Interruptible Rendering**: React can pause and resume work\n- **Priority-based Updates**: More important updates get priority\n- **Better User Experience**: Smoother interactions and animations\n- **Background Updates**: Non-blocking state updates\n\n### 2. Automatic Batching\n- **Improved Performance**: Multiple state updates batched automatically\n- **Reduced Re-renders**: Fewer unnecessary component updates\n- **Better Batching**: Works with promises, timeouts, and native event handlers\n- **Backward Compatibility**: Existing code works without changes\n\n### 3. New Suspense Features\n- **Server Components**: Render components on the server\n- **Streaming SSR**: Progressive server-side rendering\n- **Selective Hydration**: Hydrate components as needed\n- **Better Loading States**: More granular loading control\n\n## Key Features Deep Dive\n\n### Concurrent Rendering\n```jsx\n// Before React 18\nfunction App() {\n  const [count, setCount] = useState(0);\n  \n  const handleClick = () => {\n    setCount(count + 1);\n    setCount(count + 1); // This would cause two re-renders\n  };\n  \n  return <button onClick={handleClick}>{count}</button>;\n}\n\n// React 18 - Automatic batching\nfunction App() {\n  const [count, setCount] = useState(0);\n  \n  const handleClick = () => {\n    setCount(count + 1);\n    setCount(count + 1); // Now batched into single re-render\n  };\n  \n  return <button onClick={handleClick}>{count}</button>;\n}\n```\n\n### Suspense for Data Fetching\n```jsx\nimport { Suspense } from 'react';\nimport { fetchUserData } from './api';\n\nfunction UserProfile({ userId }) {\n  const user = fetchUserData(userId); // This can suspend\n  return <div>{user.name}</div>;\n}\n\nfunction App() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <UserProfile userId={123} />\n    </Suspense>\n  );\n}\n```\n\n### useId Hook\n```jsx\nimport { useId } from 'react';\n\nfunction Form() {\n  const id = useId();\n  \n  return (\n    <div>\n      <label htmlFor={id}>Name:</label>\n      <input id={id} type=\"text\" />\n    </div>\n  );\n}\n```\n\n## Performance Improvements\n\n### 1. Automatic Batching\n- **Reduced Re-renders**: Multiple state updates in one render cycle\n- **Better Performance**: Fewer DOM updates\n- **Smoother Animations**: Less jank during state changes\n- **Memory Efficiency**: Reduced memory allocation\n\n### 2. Concurrent Features\n- **Time Slicing**: Breaking work into smaller chunks\n- **Priority Scheduling**: Important updates get priority\n- **Interruption**: Can pause low-priority work\n- **Resumption**: Continue work when possible\n\n### 3. Server Components\n- **Reduced Bundle Size**: Less JavaScript sent to client\n- **Better SEO**: Server-rendered content\n- **Faster Initial Load**: Server-side rendering\n- **Progressive Enhancement**: Works without JavaScript\n\n## Migration Guide\n\n### 1. Updating to React 18\n```bash\nnpm install react@18 react-dom@18\n```\n\n### 2. Root API Changes\n```jsx\n// Before React 18\nimport ReactDOM from 'react-dom';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// React 18\nimport { createRoot } from 'react-dom/client';\n\nconst container = document.getElementById('root');\nconst root = createRoot(container);\nroot.render(<App />);\n```\n\n### 3. Strict Mode\n```jsx\n// React 18 Strict Mode intentionally double-invokes functions\n// to help detect side effects\nfunction App() {\n  console.log('This will log twice in development');\n  return <div>Hello World</div>;\n}\n```\n\n## Best Practices\n\n### 1. Leverage Automatic Batching\n- **Group State Updates**: Update related state together\n- **Use Callbacks**: For state updates that depend on previous state\n- **Avoid Manual Batching**: Let React handle it automatically\n\n### 2. Use Suspense Effectively\n- **Loading States**: Provide meaningful fallbacks\n- **Error Boundaries**: Handle errors gracefully\n- **Nested Suspense**: Use multiple Suspense boundaries\n\n### 3. Optimize with Concurrent Features\n- **useTransition**: Mark updates as non-urgent\n- **useDeferredValue**: Defer expensive updates\n- **Priority Management**: Use startTransition for low-priority updates\n\n## Common Patterns\n\n### 1. Data Fetching with Suspense\n```jsx\nfunction DataComponent() {\n  const data = use(fetchData()); // use() is a new hook\n  return <div>{data.title}</div>;\n}\n\nfunction App() {\n  return (\n    <Suspense fallback={<Spinner />}>\n      <DataComponent />\n    </Suspense>\n  );\n}\n```\n\n### 2. Concurrent Updates\n```jsx\nimport { useTransition, useDeferredValue } from 'react';\n\nfunction SearchResults({ query }) {\n  const [isPending, startTransition] = useTransition();\n  const deferredQuery = useDeferredValue(query);\n  \n  const results = useMemo(() => \n    searchData(deferredQuery), [deferredQuery]\n  );\n  \n  return (\n    <div>\n      {isPending && <div>Searching...</div>}\n      <ResultsList results={results} />\n    </div>\n  );\n}\n```\n\n## Troubleshooting\n\n### Common Issues\n- **Double Rendering**: Expected in Strict Mode development\n- **Hydration Mismatches**: Server/client content differences\n- **Performance Regression**: Check for unnecessary re-renders\n- **Suspense Boundaries**: Ensure proper error handling\n\n### Debugging Tips\n- **React DevTools**: Use the new Profiler features\n- **Concurrent Features**: Monitor with React DevTools\n- **Performance Monitoring**: Track render times\n- **Memory Usage**: Monitor for memory leaks\n\n## Future of React\n\n### Upcoming Features\n- **Server Components**: Full server-side rendering\n- **Concurrent Features**: More advanced scheduling\n- **Better DevTools**: Enhanced debugging experience\n- **Performance**: Continued optimization efforts\n\n## Conclusion\n\nReact 18 represents a significant evolution of the library, introducing powerful new features while maintaining backward compatibility. The concurrent features and automatic batching provide substantial performance improvements, while new hooks and APIs enhance developer experience.\n\n**Key Takeaways:**\n- Upgrade to React 18 for better performance\n- Leverage automatic batching for smoother updates\n- Use Suspense for better loading states\n- Implement concurrent features for complex UIs\n- Monitor performance with React DevTools\n- Stay updated with React's evolution\n\nReact 18 sets the foundation for future innovations while providing immediate benefits for current applications.",
                'type' => 'tutorial',
                'category' => 'Web Development',
                'tags' => ['react', 'javascript', 'frontend', 'performance', 'concurrent'],
                'is_monetized' => true,
                'monetization_type' => 'time_based',
                'earning_rate_less_2min' => 0.0025,
                'earning_rate_2_5min' => 0.0050,
                'earning_rate_more_5min' => 0.0120,
                'ad_type' => 'banner_ads',
                'views' => 380,
                'unique_visitors' => 310,
            ],
            [
                'title' => 'Kubernetes for Beginners: Container Orchestration Made Simple',
                'excerpt' => 'Learn Kubernetes from the ground up with this beginner-friendly guide to container orchestration and cluster management.',
                'content' => "# Kubernetes for Beginners: Container Orchestration Made Simple\n\nKubernetes has become the de facto standard for container orchestration. This comprehensive beginner's guide will help you understand and start using Kubernetes effectively.\n\n## What is Kubernetes?\n\nKubernetes (K8s) is an open-source container orchestration platform that automates the deployment, scaling, and management of containerized applications. It was originally designed by Google and is now maintained by the Cloud Native Computing Foundation (CNCF).\n\n## Why Use Kubernetes?\n\n### 1. Container Management\n- **Automated Deployment**: Deploy applications consistently\n- **Scaling**: Automatically scale based on demand\n- **Load Balancing**: Distribute traffic across containers\n- **Health Monitoring**: Monitor and restart failed containers\n\n### 2. Multi-Environment Support\n- **Development**: Local development environments\n- **Testing**: Automated testing environments\n- **Staging**: Pre-production validation\n- **Production**: High-availability production systems\n\n### 3. Cloud Agnostic\n- **Any Cloud**: Works with AWS, GCP, Azure\n- **On-Premises**: Run in your own data center\n- **Hybrid**: Mix cloud and on-premises\n- **Portable**: Move between environments easily\n\n## Core Concepts\n\n### 1. Pods\n- **Smallest Unit**: Basic deployment unit\n- **Container Wrapper**: Contains one or more containers\n- **Shared Resources**: Shared storage and network\n- **Lifecycle**: Managed by Kubernetes\n\n### 2. Services\n- **Network Abstraction**: Stable network endpoint\n- **Load Balancing**: Distribute traffic to pods\n- **Service Discovery**: Find and connect to services\n- **Types**: ClusterIP, NodePort, LoadBalancer\n\n### 3. Deployments\n- **Replica Management**: Maintain desired number of pods\n- **Rolling Updates**: Zero-downtime deployments\n- **Rollback**: Revert to previous versions\n- **Scaling**: Scale up or down as needed\n\n### 4. Namespaces\n- **Resource Isolation**: Separate environments\n- **Access Control**: Role-based permissions\n- **Resource Quotas**: Limit resource usage\n- **Organization**: Logical grouping of resources\n\n## Getting Started\n\n### 1. Installation Options\n\n#### Local Development\n```bash\n# Using Minikube\nminikube start\n\n# Using Docker Desktop\n# Enable Kubernetes in Docker Desktop settings\n\n# Using kind (Kubernetes in Docker)\nkind create cluster\n```\n\n#### Cloud Platforms\n```bash\n# Google Cloud Platform\ngcloud container clusters create my-cluster\n\n# Amazon EKS\naws eks create-cluster --name my-cluster\n\n# Azure AKS\naz aks create --resource-group myResourceGroup --name myAKSCluster\n```\n\n### 2. Basic Commands\n```bash\n# Check cluster status\nkubectl cluster-info\n\n# Get nodes\nkubectl get nodes\n\n# Get all resources\nkubectl get all\n\n# Get pods\nkubectl get pods\n```\n\n## Your First Application\n\n### 1. Create a Deployment\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n```\n\n### 2. Create a Service\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-service\nspec:\n  selector:\n    app: nginx\n  ports:\n    - protocol: TCP\n      port: 80\n      targetPort: 80\n  type: LoadBalancer\n```\n\n### 3. Deploy the Application\n```bash\n# Apply the deployment\nkubectl apply -f deployment.yaml\n\n# Apply the service\nkubectl apply -f service.yaml\n\n# Check status\nkubectl get deployments\nkubectl get services\n```\n\n## Essential kubectl Commands\n\n### 1. Resource Management\n```bash\n# Create resources\nkubectl create deployment nginx --image=nginx\n\n# Apply configuration\nkubectl apply -f config.yaml\n\n# Delete resources\nkubectl delete deployment nginx\nkubectl delete -f config.yaml\n```\n\n### 2. Monitoring and Debugging\n```bash\n# Get detailed information\nkubectl describe pod <pod-name>\n\n# View logs\nkubectl logs <pod-name>\n\n# Execute commands in pod\nkubectl exec -it <pod-name> -- /bin/bash\n\n# Port forwarding\nkubectl port-forward <pod-name> 8080:80\n```\n\n### 3. Scaling and Updates\n```bash\n# Scale deployment\nkubectl scale deployment nginx --replicas=5\n\n# Update image\nkubectl set image deployment/nginx nginx=nginx:1.16\n\n# Rollout status\nkubectl rollout status deployment/nginx\n\n# Rollback\nkubectl rollout undo deployment/nginx\n```\n\n## Advanced Concepts\n\n### 1. ConfigMaps and Secrets\n```yaml\n# ConfigMap\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: app-config\ndata:\n  database_url: \"postgres://localhost:5432/mydb\"\n  debug: \"true\"\n\n# Secret\napiVersion: v1\nkind: Secret\nmetadata:\n  name: app-secret\ntype: Opaque\ndata:\n  username: YWRtaW4=  # base64 encoded\n  password: MWYyZDFlMmU2N2Rm  # base64 encoded\n```\n\n### 2. Persistent Volumes\n```yaml\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: my-pvc\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 10Gi\n```\n\n### 3. Ingress\n```yaml\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: my-ingress\nspec:\n  rules:\n  - host: myapp.example.com\n    http:\n      paths:\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: my-service\n            port:\n              number: 80\n```\n\n## Best Practices\n\n### 1. Resource Management\n- **Resource Limits**: Set CPU and memory limits\n- **Resource Requests**: Specify minimum requirements\n- **Quality of Service**: Use appropriate QoS classes\n- **Monitoring**: Track resource usage\n\n### 2. Security\n- **RBAC**: Implement role-based access control\n- **Network Policies**: Control pod communication\n- **Secrets Management**: Secure sensitive data\n- **Image Security**: Scan container images\n\n### 3. Monitoring and Logging\n- **Health Checks**: Implement liveness and readiness probes\n- **Metrics**: Use Prometheus for monitoring\n- **Logging**: Centralize logs with ELK stack\n- **Alerting**: Set up alerts for critical issues\n\n## Common Use Cases\n\n### 1. Web Applications\n- **Frontend**: React, Vue, Angular applications\n- **Backend**: Node.js, Python, Java services\n- **Database**: PostgreSQL, MySQL, MongoDB\n- **Caching**: Redis, Memcached\n\n### 2. Microservices\n- **Service Mesh**: Istio for service communication\n- **API Gateway**: Kong, Ambassador\n- **Message Queues**: RabbitMQ, Apache Kafka\n- **Event Streaming**: Apache Kafka, NATS\n\n### 3. Data Processing\n- **Batch Jobs**: Apache Spark, Hadoop\n- **Stream Processing**: Apache Flink, Kafka Streams\n- **Machine Learning**: TensorFlow, PyTorch\n- **Data Pipelines**: Apache Airflow, Prefect\n\n## Troubleshooting\n\n### Common Issues\n- **Pod Stuck in Pending**: Check resource availability\n- **Image Pull Errors**: Verify image names and registries\n- **Service Not Accessible**: Check selectors and ports\n- **Storage Issues**: Verify persistent volume claims\n\n### Debugging Commands\n```bash\n# Check events\nkubectl get events --sort-by=.metadata.creationTimestamp\n\n# Describe resources\nkubectl describe pod <pod-name>\n\n# Check logs\nkubectl logs <pod-name> --previous\n\n# Debug networking\nkubectl run debug --image=busybox -it --rm -- /bin/sh\n```\n\n## Learning Path\n\n### 1. Beginner Level\n- **Basic Concepts**: Pods, Services, Deployments\n- **kubectl Commands**: Essential command-line operations\n- **YAML Configuration**: Writing and understanding manifests\n- **Local Development**: Minikube, Docker Desktop\n\n### 2. Intermediate Level\n- **Advanced Resources**: ConfigMaps, Secrets, Volumes\n- **Networking**: Services, Ingress, Network Policies\n- **Security**: RBAC, Pod Security Policies\n- **Monitoring**: Metrics, Logging, Alerting\n\n### 3. Advanced Level\n- **Custom Resources**: CRDs and Operators\n- **Service Mesh**: Istio, Linkerd\n- **GitOps**: ArgoCD, Flux\n- **Multi-Cluster**: Federation, Management\n\n## Conclusion\n\nKubernetes is a powerful platform that can seem complex at first, but understanding its core concepts and following best practices will help you deploy and manage applications effectively. Start with simple deployments and gradually explore more advanced features.\n\n**Key Takeaways:**\n- Start with local development environments\n- Understand core concepts: Pods, Services, Deployments\n- Practice with kubectl commands\n- Learn YAML configuration\n- Implement monitoring and logging\n- Follow security best practices\n- Join the Kubernetes community\n\nKubernetes continues to evolve, and staying updated with the latest features and best practices will help you leverage its full potential for your applications.",
                'type' => 'tutorial',
                'category' => 'DevOps',
                'tags' => ['kubernetes', 'containers', 'orchestration', 'devops', 'cloud'],
                'is_monetized' => true,
                'monetization_type' => 'time_based',
                'earning_rate_less_2min' => 0.0025,
                'earning_rate_2_5min' => 0.0050,
                'earning_rate_more_5min' => 0.0120,
                'ad_type' => 'banner_ads',
                'views' => 450,
                'unique_visitors' => 380,
            ]
        ];

        foreach ($blogPosts as $postData) {
            BlogPost::create(array_merge($postData, [
                'user_id' => $user->id,
                'slug' => Str::slug($postData['title']),
                'meta_title' => $postData['title'],
                'meta_description' => $postData['excerpt'],
                'meta_keywords' => $postData['tags'],
                'status' => 'published',
                'published_at' => now()->subDays(rand(1, 30)),
                'content_type' => 'markdown'
            ]));
        }

        $this->command->info('Additional tech blog posts created successfully!');
    }
}
